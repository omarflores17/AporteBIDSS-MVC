@model ERPMVC.DTO.ContratoDTO
@using Kendo.Mvc.UI
@{
    ViewData["Title"] = "Reporte de mora por tienda";
}
@{Layout = null;
    var messages = new Dictionary<string, string>() {
{"required","Valor requerido" }
};

}

    <div class="card card-outline-inverse">
        <div class="card-header">
            <h3 class="m-b-0 text-white">
                Reporte de Mora por Tienda
                <button id="btnConsultasGenerales" type="submit" class="fa fa-print" onclick="ConsultasGenerales()"></button>
            </h3>
        </div>
        <div class="card-body">
            <div class="row">
                <div class="col-12">
                    <div class="card">
                        <div class="row" hidden>
                            <div class="col-sm-12 col-md-12">
                                <div class="form-group">
                                    <label asp-for="ContratoId" class="control-label" style="width:100%">Id</label>
                                    <input asp-for="ContratoId" class="form-control disabled" style="min-width: 100% !important;" disabled />
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label asp-for="Fecha1" class="control-label" style="width: 100%;">Fecha Inicial</label>
                                    <kendo-datetimepicker name="Fecha1"
                                                          style="width: 100%;"
                                                          format="dd/MM/yyyy hh:mm:ss"
                                                          time-format="hh:mm:ss"
                                                          id="Fecha1"
                                                          data-val-required="La fecha es requerida"
                                                          value="Model.Fecha1" />
                                    <span asp-validation-for="Fecha1" class="text-danger"></span>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label asp-for="Fecha2" class="control-label" style="width: 100%;">Fecha Inicial</label>
                                    <kendo-datetimepicker name="Fecha2"
                                                          style="width: 100%;"
                                                          format="dd/MM/yyyy hh:mm:ss"
                                                          time-format="hh:mm:ss"
                                                          id="Fecha2"
                                                          data-val-required="La fecha es requerida"
                                                          value="Model.Fecha2" />
                                    <span asp-validation-for="Fecha2" class="text-danger"></span>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-9">
                                <div class="form-group">
                                    <label class="control-label" style="width: 100%;">Dias de mora</label>
                                    <input type="radio" id="1" name="Dias" value="1">
                                    <label for="1">1-31</label>
                                    <input type="radio" id="2" name="Dias" value="2">
                                    <label for="2">31-60</label>
                                    <input type="radio" id="3" name="Dias" value="3">
                                    <label for="3">61-90</label>
                                    <input type="radio" id="4" name="Dias" value="4">
                                    <label for="4">90-120</label>
                                    <input type="radio" id="5" name="Dias" value="5">
                                    <label for="5">120-365</label>
                                    <input type="radio" id="6" name="Dias" value="6">
                                    <label for="6">365+</label>
                                    <input type="radio" id="7" name="Dias" value="7">
                                    <label for="7">Todos</label>
                                    <span asp-validation-for="Dias" class="text-danger"></span>
                                </div>
                            </div>
                        </div>
                            <div>
                                <button id="btnConsultasGenerales" type="submit" class="btn btn-success float-right" onclick="ConsultasGenerales()">Ver Historial</button>
                            </div>
                            <div>
                                @await Html.PartialAsync("ReporteMoraTienda", new ERPMVC.DTO.ContratoDTO { ContratoId = 0 })
                            </div>
                            @*<div class="row" hidden>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label asp-for="SinFinaciar" class="control-label" style="width:100%"></label>
                                        <kendo-numerictextbox name="SinFinaciar"
                                                              format="n2"
                                                              id="SinFinaciar"
                                                              spinners="false"
                                                              min="0"
                                                              required
                                                              disabled
                                                              step="1"
                                                              style="width:100%"
                                                              value="Model.SinFinaciar" />

                                        <span asp-validation-for="SinFinaciar" class="text-danger"></span>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label asp-for="ValorContado" class="control-label" style="width:100%"></label>
                                        <kendo-numerictextbox name="ValorContado"
                                                              format="n2"
                                                              id="ValorContado"
                                                              spinners="false"
                                                              min="0"
                                                              required
                                                              disabled
                                                              step="1"
                                                              style="width:100%"
                                                              value="Model.ValorContado" />

                                        <span asp-validation-for="ValorContado" class="text-danger"></span>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label asp-for="TotalContrato" class="control-label" style="width:100%"></label>
                                        <kendo-numerictextbox name="TotalContrato"
                                                              format="n2"
                                                              id="TotalContrato"
                                                              spinners="false"
                                                              min="0"
                                                              required
                                                              disabled
                                                              step="1"
                                                              style="width:100%"
                                                              value="Model.TotalContrato" />

                                        <span asp-validation-for="TotalContrato" class="text-danger"></span>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label asp-for="SaldoCredito" class="control-label" style="width:100%"></label>
                                        <kendo-numerictextbox name="SaldoCredito"
                                                              format="n2"
                                                              id="SaldoCredito"
                                                              spinners="false"
                                                              min="0"
                                                              required
                                                              disabled
                                                              step="1"
                                                              style="width:100%"
                                                              value="Model.SaldoCredito" />

                                        <span asp-validation-for="SaldoCredito" class="text-danger"></span>
                                    </div>
                                </div>
                            </div>*@
                            <div class="modal-footer">
                                @*<a asp-action="Index" id="btncerrar" class="btn btn-default">Cerrar</a>*@
                                <button onclick="location.href='@Url.Action("Dashboard", "Home")';return false;" id="btncerrar" class="btn btn-secondary">Cerrar</button>

                            </div>                      
                    </div>
                </div>
            </div>
        </div>
    </div>

<script>

    function ConsultasGenerales() {
        RefreshCotizacionesDetail();
        //CalcularTotalDocumento();
    }

    //agrega y refresca en el grid
    function RefreshCotizacionesDetail() {
        var grid = $("#gridReporteMoraTienda").getKendoGrid();
        grid.dataSource.read();
        grid.refresh();
    }

    function setearvalor(nombrenumerico, valor) {
        var numeric = $("#" + nombrenumerico).data("kendoNumericTextBox");
        numeric.value(valor);
        numeric.trigger('change');
        numeric = null;
    }

    //function CalcularTotalDocumento() {
    //    debugger;
    //    var displayedData1 = $("#gridContratoPendiente").data("kendoGrid").dataSource.data();
    //    var displayedData = $("#gridContratoPendiente").data().kendoGrid.dataSource.view();
    //    var TotalContado = 0, TotalPagado = 0, TotalContratos = 0, TotalSaldos = 0
    //    var TotalSinFinaciar = 0, TotalValorContato = 0, TotalContrato = 0, TotalSaldoCredito = 0

    //    if (displayedData.length > 0) {
    //        $(displayedData[0].items).each(function (index, element) {
    //            var t = JSON.parse(JSON.stringify(element));

    //            TotalSinFinaciar = TotalSinFinaciar + t["SinFinaciar"];
    //            TotalValorContato = TotalValorContato + t["ValorContado"];
    //            TotalContrato = TotalContrato + t["TotalContrato"];
    //            TotalSaldoCredito = TotalSaldoCredito + t["SaldoCredito"];
    //        });
    //    }
    //    if (displayedData.length > 1) {

    //    }

    //    setearvalor('SinFinaciar', TotalSinFinaciar);
    //    setearvalor('ValorContado', TotalValorContato);
    //    setearvalor('TotalContrato', TotalContrato);
    //    setearvalor('SaldoCredito', TotalSaldoCredito);
    //}
</script>

