@model ERPMVC.Models.Vendor
@{
    ViewData["Title"] = "Detalle de Proveedor";
}



<script>



    function GetVendorId() {
        return { VendorId: $("#VendorId").val() }
    }
</script>


<div class="container-fluid">
    <div class="row">

        <div class="col-md-12">
            <h3 id="titulo" class="text-themecolor">Proveedor  @ViewData["VendorName"]</h3>
            @(Html.Kendo().TabStrip()

                                                                                                                                            .Name("tabDetalleProveedor")
                                                                                                                                            .Animation(animation =>
                                                                                                                                                animation.Open(effect =>
                                                                                                                                                    effect.Fade(FadeDirection.In)))
                                                                                                                                            .Items(tabstrip =>
                                                                                                                                            {

                                                                                                                                                tabstrip.Add().Text("Datos Generales")
                                                                                                                                                //.ImageUrl(Url.Content("~/shared/icons/sports/baseball.png"))
                                                                                                                                                .LoadContentFrom("pvwAddVendor", "Vendor", (ERPMVC.Models.Vendor)ViewData["Vendor"]);


                                                                                                                                                if (Model.VendorId > 0)
                                                                                                                                                {
                                                                                                                                                    tabstrip.Add().Text("Productos")
                                                                                                                                                    //.ImageUrl(Url.Content("~/shared/icons/sports/baseball.png"))
                                                                                                                                                    .LoadContentFrom("ListProduct", "Vendor", (ERPMVC.Models.Vendor)ViewData["product"]);
                                                                                                                                                }
                                                                                                                                                else
                                                                                                                                                {
                                                                                                                                                    tabstrip.Add().Text("Productos").Enabled(false)
                                                                                                                                                    //.ImageUrl(Url.Content("~/shared/icons/sports/baseball.png"))
                                                                                                                                                    .LoadContentFrom("ListProduct", "Vendor", (ERPMVC.Models.Vendor)ViewData["product"]);
                                                                                                                                                }

                                                                                                                                                tabstrip.Add().Text("Historico de compras")
                                                                                                                                                   //.ImageUrl(Url.Content("~/shared/icons/sports/baseball.png"))
                                                                                                                                                   .LoadContentFrom("PurchaseVendor", "Vendor", (ERPMVC.Models.Vendor)ViewData["purchase"]);

                                                                                                                                                //tabstrip.Add().Text("Hístorico de Compras")
                                                                                                                                                ////Productos que se van a almacenar , hay un listado de productos que no se pueden almacenar           //
                                                                                                                                                ////.ImageUrl(Url.Content("~/shared/icons/sports/baseball.png"))
                                                                                                                                                //.LoadContentFrom(@Url.Action("Compras", "Vendor"));



                                                                                                                                            })
                                                                                                                                            .SelectedIndex(0)
            )
        </div>


     
    
    </div>
</div>

@section scripts{
    <script>
         function BackVendor() {
        window.location.href = "@Url.Action("Index", "Vendor")";
        }

      function SaveVendor() {
          debugger;
         // $("#btnVendor").prop("disabled", true);
          if ($('#RTNAlert').is(':hidden') && $('#PhoneAlert').is(':hidden')
              && $('#PhoneReferencetwoAlert').is(':hidden') && $('#PhoneReferenceoneAlert').is(':hidden')) {
              var txtObj = document.getElementById("VendorName");
              var txtObj2 = document.getElementById("Address");
              var txtObj3 = document.getElementById("Email");

              txtObj.value = txtObj.value.replace(/^\s+/, ""); //Left trim
              txtObj.value = txtObj.value.replace(/\s+$/, ""); //Right trim

              txtObj2.value = txtObj2.value.replace(/^\s+/, ""); //Left trim
              txtObj2.value = txtObj2.value.replace(/\s+$/, ""); //Right trim

              txtObj3.value = txtObj3.value.replace(/^\s+/, ""); //Left trim
              txtObj3.value = txtObj3.value.replace(/\s+$/, ""); //Right trim

              var dataObject = {
                  'VendorId': $("#VendorId").val() === "" ? "0" : $("#VendorId").val(),
                  'VendorName': $("#VendorName").val(),
                  'VendorTypeId': $("#VendorTypeId").val(),
                  'Address': $("#Address").val(),
                  'CityId': $("#CityId").val(),
                  'CountryId': $("#CountryId").val(),
                  'StateId': $("#StateId").val(),
                  'ZipCode': $("#ZipCode").val(),
                  'Phone': $("#Phone").val(),
                  'Email': $("#Email").val(),
                  'ContactPerson': $("#ContactPerson").val(),
                  'CompanyReferenceone': $("#CompanyReferenceone").val(),
                  'CompanyReferencetwo': $("#CompanyReferencetwo").val(),
                  'CurrencyId': $("#CurrencyId").val(),
                  'Estado': $("#IdEstado").data("kendoDropDownList").text(),
                  'IdEstado': $("#IdEstado").val(),
                  'Identidad': $("#Identidad").val(),
                  'PhoneReferenceone': $("#PhoneReferenceone").val(),
                  'PhoneReferencetwo': $("#PhoneReferencetwo").val(),
                  //'QtyMin': $("#QtyMin").val(),
                  'QtyMonth': $("#QtyMonth").val(),
                  'RTN': $("#RTN").val(),

              };

              console.log(dataObject);
              var validator = $("#frmvendor").data("kendoValidator");
              if (validator.validate()) {
                  $.ajax({
                      url: '@Url.Action("SaveVendor", "Vendor")',
                      method: 'POST',
                      datatype: "json",
                      contentType: 'application/json',
                      async: false,
                      data: JSON.stringify(dataObject),
                      success: function (data) {
                          $("#VendorId").val(data.VendorId);
                          swal("Proveedor", "Se han Guardado los cambios", "success");
                          BackVendor();
                      },
                      error: function (XMLHttpRequest, textStatus, errorThrown) {
                          swal(textStatus + ": " + XMLHttpRequest.responseText);
                          $("#btnVendor").show();
                          $("#btnVendor").prop("disabled", false);
                          notification.show({
                              title: "Validación",
                              message: textStatus + ": " + XMLHttpRequest.responseText
                          }, "error");

                      }

                  });
              }


          }
          else {
              swal("Proveedor", "Datos Incompletos en el formulario!", "info");
          }

      }
    </script>
}



<style>
    .modal-backdrop {
        /* bug fix - no overlay */
        display: none;
    }

    .modal-dialog {
        margin: 2px auto;
        z-index: 1100 !important;
    }

    .modal-open .modal {
        overflow: hidden;
    }

    .modal-body {
        overflow: auto;
        min-height: 1700;
    }

    .fixed-div {
        width: 100%;
        position: fixed;
        z-index: 1051; /* anything above 1050*/
        background: #fff;
        box-shadow: 0 5px 20px 4px rgba(0,0,0,.1);
    }
</style>



<div class="container-fluid">

</div>